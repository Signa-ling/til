# nohup + ampersand

それぞれの役割をよくわかってなかったのでメモ


```shell
$ nohup COMMAND [ARG] ...
```

とするのが基本形で

- `nohup`: コマンドの先頭に付けることで、シェルが終了してもプロセスが継続するようにする。
- `<COMMAND>[ARG]`: 実行したいコマンドと引数

例えば

```shell
$ nohup ruby sample.rb
```

みたいな感じで使う。

## `&` を組み合わせる

`nohup` だけだとバックグラウンドで処理が継続実行されない。ここでいうバックグラウンドとは、コマンドが終了するのを待たずに即座に入力受付状態に戻れること。

したがって、`Ctrl + C` のようなフォアグラウンドのコマンドに対し送られるシグナルが効く。

バックグラウンドでの継続実行をするためには、コマンドの末尾に `&` をつける。

```shell
$ COMMAND &
```

これを `nohup` と組み合わせる場合は以下のように書けば良い。

このコマンドを叩くことでバックグラウンドで処理を実行しつつターミナルを終了できる。これの嬉しいところは、 SSH 接続時の回線切断などによるコマンドの叩き直しを回避できること。

```shell
$ nohup COMMAND [ARG] &
```


## 参考

- [バックグラウンドでコマンドを実行する](https://docs.oracle.com/cd/E19253-01/816-3946/commands-7/index.html)
- [[Linux] Terminalを閉じてもバックグラウンドの処理を実行し続ける - nohup](https://blog.katsubemakito.net/linux/nohup)
  - 流し読みしかしてないけど、`nohup` や `&` をつけ忘れたときのリカバリー方法とか書いてある